================================================================================
RESUMEN DETALLADO DEL MODELO MUSICVAE
================================================================================

CONFIGURACIÓN:
----------------------------------------
features_dim: 84
sequence_length: 16
latent_dim: 256
encoder_lstm_units: [256, 128, 512]
conductor_lstm_units: 256
decoder_lstm_units: 512

ENCODER:
----------------------------------------
Model: "hierarchical_encoder"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                  ┃ Output Shape              ┃         Param # ┃ Connected to               ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ piano_roll_input (InputLayer) │ (None, 16, 84)            │               0 │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ bidirectional_encoder_1       │ (None, 16, 512)           │         698,368 │ piano_roll_input[0][0]     │
│ (Bidirectional)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ bidirectional_encoder_2       │ (None, 16, 256)           │         656,384 │ bidirectional_encoder_1[0… │
│ (Bidirectional)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ bidirectional_encoder_summary │ (None, 1024)              │       3,149,824 │ bidirectional_encoder_2[0… │
│ (Bidirectional)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ latent_mean (Dense)           │ (None, 256)               │         262,400 │ bidirectional_encoder_sum… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ latent_log_variance (Dense)   │ (None, 256)               │         262,400 │ bidirectional_encoder_sum… │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ z_sampling (Lambda)           │ (None, 256)               │               0 │ latent_mean[0][0],         │
│                               │                           │                 │ latent_log_variance[0][0]  │
└───────────────────────────────┴───────────────────────────┴─────────────────┴────────────────────────────┘
 Total params: 5,029,376 (19.19 MB)
 Trainable params: 5,029,376 (19.19 MB)
 Non-trainable params: 0 (0.00 B)


DECODER:
----------------------------------------
Model: "hierarchical_autoregressive_decoder"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                  ┃ Output Shape              ┃         Param # ┃ Connected to               ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ latent_vector_z (InputLayer)  │ (None, 256)               │               0 │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ repeat_latent_vector          │ (None, 16, 256)           │               0 │ latent_vector_z[0][0]      │
│ (RepeatVector)                │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ conductor_planning_lstm       │ (None, 16, 256)           │         525,312 │ repeat_latent_vector[0][0] │
│ (LSTM)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ teacher_forcing_sequence      │ (None, 16, 84)            │               0 │ -                          │
│ (InputLayer)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ lstm_hidden_state             │ (None, 512)               │               0 │ -                          │
│ (InputLayer)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ lstm_cell_state (InputLayer)  │ (None, 512)               │               0 │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ autoregressive_decoder        │ [(None, 16, 84), (None,   │       1,790,036 │ conductor_planning_lstm[0… │
│ (AutoregressiveDecoderLayer)  │ 512), (None, 512)]        │                 │ teacher_forcing_sequence[… │
│                               │                           │                 │ lstm_hidden_state[0][0],   │
│                               │                           │                 │ lstm_cell_state[0][0]      │
└───────────────────────────────┴───────────────────────────┴─────────────────┴────────────────────────────┘
 Total params: 2,315,348 (8.83 MB)
 Trainable params: 2,315,348 (8.83 MB)
 Non-trainable params: 0 (0.00 B)


VAE COMPLETO:
----------------------------------------
Model: "music_vae"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ hierarchical_encoder (Functional)    │ ((None, 256), (None, 256),  │       5,029,376 │
│                                      │ (None, 256))                │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ hierarchical_autoregressive_decoder  │ ((None, 16, 84), (None,     │       2,315,348 │
│ (Functional)                         │ 512), (None, 512))          │                 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 7,344,724 (28.02 MB)
 Trainable params: 7,344,724 (28.02 MB)
 Non-trainable params: 0 (0.00 B)


DETALLES ADICIONALES:
----------------------------------------
Parámetros totales: 7,344,724
Parámetros entrenables: 7,344,724
Parámetros no entrenables: 0
