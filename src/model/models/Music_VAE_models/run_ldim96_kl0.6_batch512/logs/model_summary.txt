================================================================================
RESUMEN DETALLADO DEL MODELO MUSICVAE
================================================================================

CONFIGURACIÓN:
----------------------------------------
features_dim: 84
sequence_length: 16
latent_dim: 96
encoder_lstm_units: [56, 28, 224]
conductor_lstm_units: 112
decoder_lstm_units: 224
recurrent_dropout: 0.2
dropout_rate: 0.35
l2_regularization: 0.00015

ENCODER:
----------------------------------------
Model: "hierarchical_encoder"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                  ┃ Output Shape              ┃         Param # ┃ Connected to               ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ piano_roll_input (InputLayer) │ (None, 16, 84)            │               0 │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ encoder_lstm_1                │ (None, 16, 112)           │          63,168 │ piano_roll_input[0][0]     │
│ (Bidirectional)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ encoder_lstm_2                │ (None, 16, 56)            │          31,584 │ encoder_lstm_1[0][0]       │
│ (Bidirectional)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ encoder_lstm_summary          │ (None, 448)               │         503,552 │ encoder_lstm_2[0][0]       │
│ (Bidirectional)               │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ dropout (Dropout)             │ (None, 448)               │               0 │ encoder_lstm_summary[0][0] │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ latent_mean (Dense)           │ (None, 96)                │          43,104 │ dropout[0][0]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ latent_log_variance (Dense)   │ (None, 96)                │          43,104 │ dropout[0][0]              │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ z_sampling (Lambda)           │ (None, 96)                │               0 │ latent_mean[0][0],         │
│                               │                           │                 │ latent_log_variance[0][0]  │
└───────────────────────────────┴───────────────────────────┴─────────────────┴────────────────────────────┘
 Total params: 684,512 (2.61 MB)
 Trainable params: 684,512 (2.61 MB)
 Non-trainable params: 0 (0.00 B)


DECODER:
----------------------------------------
Model: "hierarchical_autoregressive_decoder"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                  ┃ Output Shape              ┃         Param # ┃ Connected to               ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ latent_vector_z (InputLayer)  │ (None, 96)                │               0 │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ repeat_latent_vector          │ (None, 16, 96)            │               0 │ latent_vector_z[0][0]      │
│ (RepeatVector)                │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ conductor_planning_lstm       │ (None, 16, 112)           │          93,632 │ repeat_latent_vector[0][0] │
│ (LSTM)                        │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ teacher_forcing_sequence      │ (None, 16, 84)            │               0 │ -                          │
│ (InputLayer)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ lstm_hidden_state             │ (None, 224)               │               0 │ -                          │
│ (InputLayer)                  │                           │                 │                            │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ lstm_cell_state (InputLayer)  │ (None, 224)               │               0 │ -                          │
├───────────────────────────────┼───────────────────────────┼─────────────────┼────────────────────────────┤
│ autoregressive_decoder        │ [(None, 16, 84), (None,   │         396,116 │ conductor_planning_lstm[0… │
│ (AutoregressiveDecoderLayer)  │ 224), (None, 224)]        │                 │ teacher_forcing_sequence[… │
│                               │                           │                 │ lstm_hidden_state[0][0],   │
│                               │                           │                 │ lstm_cell_state[0][0]      │
└───────────────────────────────┴───────────────────────────┴─────────────────┴────────────────────────────┘
 Total params: 489,748 (1.87 MB)
 Trainable params: 489,748 (1.87 MB)
 Non-trainable params: 0 (0.00 B)


VAE COMPLETO:
----------------------------------------
Model: "music_vae"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ hierarchical_encoder (Functional)    │ ((None, 96), (None, 96),    │         684,512 │
│                                      │ (None, 96))                 │                 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ hierarchical_autoregressive_decoder  │ ((None, 16, 84), (None,     │         489,748 │
│ (Functional)                         │ 224), (None, 224))          │                 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 1,174,260 (4.48 MB)
 Trainable params: 1,174,260 (4.48 MB)
 Non-trainable params: 0 (0.00 B)


DETALLES ADICIONALES:
----------------------------------------
Parámetros totales: 1,174,260
Parámetros entrenables: 1,174,260
Parámetros no entrenables: 0
